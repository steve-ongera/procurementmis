{% extends 'base.html' %}
{% load humanize %}

{% block title %}Adjust Stock - {{ stock.item.name }}{% endblock %}

{% block content %}
<div class="page-header">
    <div>
        <h1>Adjust Stock: {{ stock.item.name }}</h1>
        <div class="breadcrumb">
            <a href="{% url 'dashboard' %}">Home</a>
            <span>/</span>
            <a href="{% url 'stock_list' %}">Stock Items</a>
            <span>/</span>
            <a href="{% url 'stock_detail' stock.id %}">{{ stock.item.code }}</a>
            <span>/</span>
            <span>Adjust</span>
        </div>
    </div>
</div>

<form method="post">
    {% csrf_token %}
    
    <div class="card">
        <div class="card-header">
            <h2>Current Stock Information</h2>
        </div>
        <div class="card-body">
            <div class="info-grid">
                <div class="info-item">
                    <label>Item</label>
                    <p>{{ stock.item.name }} ({{ stock.item.code }})</p>
                </div>
                <div class="info-item">
                    <label>Store</label>
                    <p>{{ stock.store.name }}</p>
                </div>
                <div class="info-item">
                    <label>Current Quantity</label>
                    <p class="highlight">{{ stock.quantity_on_hand|floatformat:2 }} {{ stock.item.unit_of_measure }}</p>
                </div>
                <div class="info-item">
                    <label>Average Unit Cost</label>
                    <p>KES {{ stock.average_unit_cost|floatformat:2|intcomma }}</p>
                </div>
            </div>
        </div>
    </div>
    
    <div class="card">
        <div class="card-header">
            <h2>Adjustment Details</h2>
        </div>
        <div class="card-body">
            <div class="form-group">
                <label>Adjustment Type *</label>
                <select name="adjustment_type" required>
                    <option value="">Select Type</option>
                    <option value="ADD">Add Stock</option>
                    <option value="SUBTRACT">Subtract Stock</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>Quantity *</label>
                <input type="number" name="quantity" step="0.01" min="0.01" required>
            </div>
            
            <div class="form-group">
                <label>Reason for Adjustment *</label>
                <textarea name="reason" rows="4" required placeholder="Explain the reason for this adjustment..."></textarea>
            </div>
        </div>
    </div>
    
    <div class="form-actions">
        <a href="{% url 'stock_detail' stock.id %}" class="btn">Cancel</a>
        <button type="submit" class="btn btn-primary">Submit Adjustment</button>
    </div>
</form>
{% endblock %}
